(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["module-reprocess"],{a549:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wrapper"},[s("Pri_TopBar"),s("Pri_SideBar"),s("div",{staticClass:"content-wrapper"},[s("section",{staticClass:"content-header"},[s("h1",[t._v("\n        "+t._s(t.$t("pri.moduleReprocessView.title"))),s("small",[t._v(t._s(t.version))]),s("small",[t._v(t._s(t.$t("pri.moduleReprocessView.subTitle"))+" "),s("span",{staticClass:"btn btn-xs bg-olive "},[t._v(t._s(t.$t("datasource.d202012")))])])]),s("ol",{staticClass:"breadcrumb"},[s("router-link",{attrs:{tag:"li",to:"/dashboard"}},[s("a",{attrs:{href:"javascript:;"}},[s("i",{staticClass:"fa fa-cogs"}),s("span",{domProps:{innerHTML:t._s(t.$t("common.title"))}})])]),s("li",{staticClass:"active"},[t._v(t._s(t.$t("pri.moduleReprocessView.title")))])],1)]),s("section",{staticClass:"content"},[s("div",{staticClass:"box"},[s("div",{staticClass:"box-header"},[s("h3",{staticClass:"box-title"},[t._v(t._s(t.$t("pri.moduleReprocessView.config.title")))]),t._m(0)]),s("div",{staticClass:"box-body"},[s("form",{staticClass:"form-horizontal row"},[s("div",{staticClass:"col-sm-3"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input_ore_id"}},[t._v(t._s(t.$t("pri.moduleReprocessView.config.buildCostRate")))]),s("div",{staticClass:"col-sm-8"},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.buildCostRate,expression:"buildCostRate"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.buildCostRate},on:{input:function(e){e.target.composing||(t.buildCostRate=e.target.value)}}}),s("span",{staticClass:"input-group-addon"},[t._v("%")])])])])]),s("div",{staticClass:"col-sm-3"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input_ore_id"}},[t._v(t._s(t.$t("pri.quickInputSkill.config.lvNumber")))]),s("div",{staticClass:"col-sm-8"},[s("QuickInputSkill",{attrs:{t_id:t.$commonConst.skillQuickInputType.refine},on:{"set-skill-effect":t.setSkillEffect}})],1)])]),s("div",{staticClass:"col-sm-3"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"col-sm-4 control-label",attrs:{for:"input_ore_id"}},[t._v(t._s(t.$t("pri.moduleReprocessView.config.buildDefaultItemCount")))]),s("div",{staticClass:"col-sm-8"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.buildDefaultItemCount,expression:"buildDefaultItemCount"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.buildDefaultItemCount},on:{input:function(e){e.target.composing||(t.buildDefaultItemCount=e.target.value)}}})])])])])])]),s("div",{staticClass:"box box-primary"},[s("div",{staticClass:"box-footer"},[s("eeAccountWorkbenchSection",{attrs:{saveData:t.AccountWorkbench_saveData},on:{"aw-dataLoaded":t.aw_dataLoaded}})],1)]),s("TopicDisplay",{ref:"TopicDisplay"}),s("div",{staticClass:"box box-primary"},[s("div",{staticClass:"box-header"},[s("h3",{staticClass:"box-title"},[t._v(t._s(t.$t("pri.moduleReprocessView.result.title")))]),s("eePriceSelector",{staticClass:"pull-right",attrs:{input_flag_showDetailPrice:t.eePriceSelector_params.showDetailPrice,input_flag_showSumPrice:t.eePriceSelector_params.showSumPrice,input_flag_selectedPriceType:t.eePriceSelector_params.selectedPriceType,input_flag_stopPriceUpdate:t.awFlag.loadingAW,input_show_btnSum:!1},on:{"price-type-changed":t.eePriceSelector_priceTypeChanged,"switch-flag":function(e){var s=arguments.length,i=Array(s);while(s--)i[s]=arguments[s];return t.eeSwitchObjFlag.apply(void 0,[t.eePriceSelector_params].concat(i))}}})],1),s("div",{staticClass:"box-body ee-tableContent"},[s("table",{staticClass:"table table-bordered"},[s("tbody",[s("tr",{directives:[{name:"show",rawName:"v-show",value:t.eePriceSelector_params.showDetailPrice,expression:"eePriceSelector_params.showDetailPrice"}]},[s("td"),s("td"),s("td"),s("td"),t._l(["m_st","m_lj","m_ly","m_tws","m_cxx","m_sy","m_csk"],function(e){return s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.priceList[e],expression:"priceList[sumIndex]"}],staticClass:"form-control",domProps:{value:t.priceList[e]},on:{input:function(s){s.target.composing||t.$set(t.priceList,e,s.target.value)}}})])}),s("td"),s("td")],2),s("tr",[s("th",{staticStyle:{"min-width":"6px"}},[t._v("#")]),s("th",{staticStyle:{"min-width":"200px",width:"15%"}},[t._v(t._s(t.$t("pri.moduleReprocessView.result.table.title.r_item")))]),s("th",{staticStyle:{"min-width":"90px",width:"8%"}},[t._v(t._s(t.$t("pri.moduleReprocessView.result.table.title.r_cnt")))]),s("th",{staticStyle:{"min-width":"90px",width:"8%"}},[t._v(t._s(t.$t("pri.moduleReprocessView.result.table.title.r_isk_output")))]),t._l(["m_st","m_lj","m_ly","m_tws","m_cxx","m_sy","m_csk"],function(e){return s("th",{staticStyle:{"min-width":"90px",width:"8%"}},[t._v("\n                    "+t._s(t.$t("material."+e))+"\n                  ")])}),s("th",{staticStyle:{"min-width":"90px",width:"8%"}},[t._v(t._s(t.$t("pri.moduleReprocessView.result.table.title.r_volnum_output")))]),s("th",{staticStyle:{"min-width":"5px"}},[t._v(t._s(t.$t("common.op")))])],2),t._l(t.reprocessList,function(e,i){return s("ModuleReprocessView_OneReprocessTR",{attrs:{k:i,buildCostRate:t.buildCostRate,loadedPriceList:t.priceList,select2_moduleList:t.select2_moduleTitleList},on:{"item-delete":t.item_delete,"item-changed":t.item_changed},model:{value:t.reprocessList[i],callback:function(e){t.$set(t.reprocessList,i,e)},expression:"reprocessList[k]"}})}),s("tr",[s("td",{attrs:{colspan:"2"}},[s("div",{staticClass:"input-group input-group-sm"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.addNewItemCount,expression:"addNewItemCount"}],staticClass:"form-control",domProps:{value:t.addNewItemCount},on:{input:function(e){e.target.composing||(t.addNewItemCount=e.target.value)}}}),s("span",{staticClass:"input-group-btn"},[s("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.item_addNewItem()}}},[s("span",{staticClass:"fa  fa-plus"})])])])]),t._l(["r_cnt","r_isk_output","r_st","r_lj","r_ly","r_tws","r_cxx","r_sy","r_csk"],function(e){return s("td",[t._v("\n                    "+t._s(t.cal_sumOutput(e))+"\n                  ")])}),s("td",[t._v("\n                    "+t._s(t.cal_sumOutput("r_volumn_output"))+" / "+t._s(t.cal_sumOutput("r_volumn_item"))+"\n                  ")]),s("td")],2)],2)])])])],1)]),s("Pri_FooterBar")],1)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"box-tools pull-right"},[s("button",{staticClass:"btn btn-box-tool",attrs:{"data-widget":"collapse","data-toggle":"tooltip",title:"","data-original-title":"Collapse"}},[s("i",{staticClass:"fa fa-minus"})]),s("button",{staticClass:"btn btn-box-tool",attrs:{"data-widget":"remove","data-toggle":"tooltip",title:"Remove"}},[s("i",{staticClass:"fa fa-times"})])])}],r=(s("c5f6"),s("96cf"),s("3b8d")),o=s("f499"),l=s.n(o),c=(s("ac6a"),s("7374")),n=s("bf26"),u=s("325e"),d=s("bcea"),m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",[t._v(t._s(t.k+1)+". ")]),s("td",[s("Select2",{attrs:{options:t.select2_moduleList},on:{change:t.item_changed},model:{value:t.value.r_item_id,callback:function(e){t.$set(t.value,"r_item_id",e)},expression:"value.r_item_id"}})],1),s("td",[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.value.r_cnt,expression:"value.r_cnt",modifiers:{number:!0}}],staticClass:"form-control",domProps:{value:t.value.r_cnt},on:{input:function(e){e.target.composing||t.$set(t.value,"r_cnt",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),s("td",{staticStyle:{"vertical-align":"middle"}},[t._v(t._s(t.eeFormatNumber(t.value.r_isk_output)))]),s("td",{staticStyle:{"vertical-align":"middle"}},[t._v(t._s(t.eeFormatNumber(t.value.r_st)))]),s("td",{staticStyle:{"vertical-align":"middle"}},[t._v(t._s(t.eeFormatNumber(t.value.r_lj)))]),s("td",{staticStyle:{"vertical-align":"middle"}},[t._v(t._s(t.eeFormatNumber(t.value.r_ly)))]),s("td",{staticStyle:{"vertical-align":"middle"}},[t._v(t._s(t.eeFormatNumber(t.value.r_tws)))]),s("td",{staticStyle:{"vertical-align":"middle"}},[t._v(t._s(t.eeFormatNumber(t.value.r_cxx)))]),s("td",{staticStyle:{"vertical-align":"middle"}},[t._v(t._s(t.eeFormatNumber(t.value.r_sy)))]),s("td",{staticStyle:{"vertical-align":"middle"}},[t._v(t._s(t.eeFormatNumber(t.value.r_csk)))]),s("td",{staticStyle:{"vertical-align":"middle"}},[t._v(t._s(t.eeFormatNumber(t.value.r_volumn_output))+" / "+t._s(t.eeFormatNumber(t.value.r_volumn_item)))]),s("td",{staticStyle:{"vertical-align":"middle"}},[s("span",{staticClass:"fa fa-remove text-red ee-pointer ee-opBtn16",on:{click:t.item_delete}})])])},p=[],v=s("6f44"),h={name:"ModuleReprocessView_OneReprocessTR",data:function(){return{theId:0}},props:{k:{required:!0},buildCostRate:{required:!0},select2_moduleList:{type:[Array],required:!0},loadedPriceList:{type:[Object]},value:{type:[Object]}},computed:{},watch:{"value.rModuleReprocess":function(t,e){this.cal_output()},"value.r_cnt":function(t,e){this.cal_output()},buildCostRate:function(t,e){this.cal_output()},loadedPriceList:{handler:function(t,e){this.cal_output()},deep:!0}},methods:{getUniqueId:function(){return Math.floor(1e6*Math.random())},wrapData:function(t){var e=t;return e},member_weightChanged:function(){this.$emit("weight-changed")},item_delete:function(){this.$emit("item-delete",this.k)},item_changed:function(){this.$emit("item-changed",this.k,this.value.r_item_id)},cal_output:function(){if(void 0==this.value.rModuleReprocess)return!1;for(var t=["r_st","r_lj","r_ly","r_tws","r_cxx","r_sy","r_csk","r_me"],e=0,s=0,i=0;i<t.length;i++){var a=t[i];this.value[a]=_.floor(this.buildCostRate/100*this.value.r_cnt*this.value.rModuleReprocess["m"+a],2),e+=this.value[a]*Number(this.loadedPriceList["m"+a.substr(1)]),s+=this.value[a]}this.value.r_isk_output=_.floor(e,2),this.value.r_volumn_item=_.floor(this.value.rModuleReprocess.mr_volumn*this.value.r_cnt,2),this.value.r_volumn_output=_.floor(s/100)}},created:function(){this.theId=Math.floor(1e6*Math.random())},mounted:function(){},mixins:[],components:{Select2:v["a"]}},f=h,b=s("2877"),w=Object(b["a"])(f,m,p,!1,null,null,null),g=w.exports,C=s("d735"),x=s("8ec3"),R=s("3ab5"),y=s("61c1"),L=s("a97d"),S=s("37e4"),k={name:"ModuleReprocessView",data:function(){return{version:"v3.6.4",buildCostRate:30,buildDefaultItemCount:1,addNewItemCount:1,reprocessList:[],emptyOneReprocessItem:{r_item_id:0,r_cnt:1,r_isk_output:0,r_volumn_output:0,r_volumn_item:0,r_st:0,r_lj:0,r_ly:0,r_tws:0,r_cxx:0,r_sy:0,r_csk:0,r_me:0,rModuleReprocess:{mr_id:"",mr_title:"",mr_titleEn:"",mr_volumn:0,mr_st:0,mr_lj:0,mr_ly:0,mr_tws:0,mr_cxx:0,mr_sy:0,mr_csk:0,mr_me:0}},loadedModuleReprocessTitleList:[],loadedModuleReprocessDetailList:{},tableData:{columns:[],options:{tableClass:"table table-bordered text-center table-hover table-striped",showTableFooter:!0,sortContainerSize:2,tool_allowGlobalSearch:!0,tool_showRefresh:!0,tool_showColumns:!0}}}},computed:{AccountWorkbench_saveData:function(){var t={reprocessList:[],buildCostRate:this.buildCostRate,priceList:this.priceList,eePriceSelector_params:this.eePriceSelector_params};return this.reprocessList.forEach(function(e,s){t.reprocessList.push({r_item_id:e.r_item_id,r_cnt:e.r_cnt})}),l()(t)},select2_moduleTitleList:function(){var t=[];for(var e in this.loadedModuleReprocessTitleList){var s=this.loadedModuleReprocessTitleList[e],i=s.mr_titleEn;"zh"==this.$i18n.locale&&(i=s.mr_title),t.push({id:s.mr_id,text:i})}return t}},watch:{},methods:{wrapData:function(t){var e=t;return e},loadModuleReprocessList:function(){var t=this,e=this,s="v1/module-reprocess";this.$axios.get(s).then(function(s){var i=[];for(var a in s.data)i.push(t.wrapData(s.data[a]));e.loadedModuleReprocessTitleList=i}).catch(function(t){})},item_addNewItem:function(){this.addNewItemCount<1&&(this.addNewItemCount=1);for(var t=0;t<this.addNewItemCount;t++){var e=this.eeMergeData(this.emptyOneReprocessItem,{r_cnt:this.buildDefaultItemCount});this.reprocessList.push(e)}},item_delete:function(t){this.reprocessList.splice(t,1)},item_changed:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e,s){var i,a,r=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!(s<1)){t.next=2;break}return t.abrupt("return",!1);case 2:if(i={},void 0!=this.loadedModuleReprocessDetailList[s]){t.next=7;break}return a="v1/module-reprocess/"+s,t.next=7,this.$axios.get(a).then(function(t){r.loadedModuleReprocessDetailList[s]=t.data}).catch(function(t){});case 7:i=this.loadedModuleReprocessDetailList[s],this.reprocessList[e]["rModuleReprocess"]=i,e==this.reprocessList.length-1&&this.item_addNewItem();case 10:case"end":return t.stop()}},t,this)}));function e(e,s){return t.apply(this,arguments)}return e}(),cal_sumOutput:function(t){for(var e=0,s=0;s<this.reprocessList.length;s++){var i=this.reprocessList[s];void 0!=i[t]&&(e+=Number(i[t]))}return this.eeFormatNumber(_.floor(e,2))},setSkillEffect:function(t){this.buildCostRate=_.floor(30*t.costRate,2)},aw_dataLoaded:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var s,i,a,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:for(a in s=this,i=JSON.parse(e.aw_data),this.reprocessList=[],i)r=i[a],"reprocessList"==a?r.forEach(function(t,e){s.reprocessList.push(s.eeMergeData(s.emptyOneReprocessItem,t)),s.item_changed(e,t.r_item_id)}):s[a]=r;this.awFlag.loadingAW=!1;case 5:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},mixins:[y["a"],S["a"]],components:{Pri_TopBar:c["a"],Pri_SideBar:n["a"],Pri_FooterBar:u["a"],Pri_RightBar:d["a"],ModuleReprocessView_OneReprocessTR:g,QuickInputSkill:x["a"],TopicDisplay:C["a"],eeAccountWorkbenchSection:R["a"],eePriceSelector:L["a"]},created:function(){},mounted:function(){this.loadModuleReprocessList(),void 0==this.$route.params.aw_id?this.item_addNewItem():this.awFlag.loadingAW=!0,this.eePriceSelector_params.showDetailPrice=!0},destroyed:function(){},beforeMount:function(){document.body.className="hold-transition skin-red sidebar-mini sidebar-collapse"}},P=k,N=Object(b["a"])(P,i,a,!1,null,null,null);e["default"]=N.exports}}]);